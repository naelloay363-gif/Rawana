<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù†Ø¸Ø§Ù… Ù…Ø­Ø§Ø³Ø¨Ø© ÙˆÙ…Ø®Ø²Ù†</title>
<style>
body{font-family:tahoma;background:#f2f2f2;margin:0}
header{background:#2f80ed;color:#fff;padding:15px;text-align:center}
nav{display:flex;gap:6px;overflow:auto;padding:10px;background:#e6eeff}
nav button{border:none;padding:10px 14px;border-radius:20px;cursor:pointer}
nav button.active{background:#2f80ed;color:#fff}
section{display:none;padding:15px}
section.active{display:block}
.card{background:#fff;padding:15px;border-radius:10px;margin-bottom:10px}
input,select,button{width:100%;padding:10px;margin:5px 0}
.green{background:#27ae60;color:#fff}
.red{background:#eb5757;color:#fff}
.blue{background:#2f80ed;color:#fff}
table{width:100%;border-collapse:collapse}
th,td{border-bottom:1px solid #ddd;padding:6px;text-align:center}
</style>
</head>
<body>

<header>Ù†Ø¸Ø§Ù… Ù…Ø­Ø§Ø³Ø¨Ø© + Ù…Ø®Ø²Ù†</header>

<nav>
<button onclick="show('sales')" class="active">Ù…Ø¨ÙŠØ¹Ø§Øª</button>
<button onclick="show('store')">Ø§Ù„Ù…Ø®Ø²Ù†</button>
<button onclick="show('expenses')">Ù…ØµØ§Ø±ÙŠÙ</button>
<button onclick="show('cash')">Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚</button>
<button onclick="show('reports')">ØªÙ‚Ø§Ø±ÙŠØ±</button>
<button onclick="show('backup')">Ù†Ø³Ø®Ø©</button>
</nav>

<!-- Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª -->
<section id="sales" class="active">
<div class="card">
<h3>Ø¨ÙŠØ¹</h3>
<select id="saleItem"></select>
<input id="saleQty" type="number" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©" value="1">
<select id="saleType">
<option value="cash">ÙƒØ§Ø´</option>
<option value="bank">Ø¨Ù†Ùƒ</option>
</select>
<button class="green" onclick="addSale()">ØªÙ†ÙÙŠØ° Ø§Ù„Ø¨ÙŠØ¹</button>
</div>
</section>

<!-- Ø§Ù„Ù…Ø®Ø²Ù† -->
<section id="store">
<div class="card">
<h3>Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù</h3>
<input id="itemName" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù">
<input id="itemQty" type="number" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
<input id="itemPrice" type="number" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹">
<button class="blue" onclick="addItem()">Ø­ÙØ¸</button>
</div>

<div class="card">
<h3>Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h3>
<table>
<tr><th>Ø§Ù„ØµÙ†Ù</th><th>ÙƒÙ…ÙŠØ©</th><th>Ø³Ø¹Ø±</th></tr>
<tbody id="storeTable"></tbody>
</table>
</div>
</section>

<!-- Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ -->
<section id="expenses">
<div class="card">
<h3>Ù…ØµØ±ÙˆÙ</h3>
<input id="expAmount" type="number" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº">
<select id="expType">
<option value="cash">ÙƒØ§Ø´</option>
<option value="bank">Ø¨Ù†Ùƒ</option>
</select>
<button class="red" onclick="addExpense()">ØªØ³Ø¬ÙŠÙ„</button>
</div>
</section>

<!-- Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ -->
<section id="cash">
<div class="card">
<p>ğŸ’µ ÙƒØ§Ø´: <b id="cashVal">0</b></p>
<p>ğŸ¦ Ø¨Ù†Ùƒ: <b id="bankVal">0</b></p>
</div>
</section>

<!-- Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± -->
<section id="reports">
<div class="card">
<h3>ØªÙ‚Ø§Ø±ÙŠØ±</h3>
<select id="reportType" onchange="renderReports()">
<option value="day">ÙŠÙˆÙ…ÙŠ</option>
<option value="month">Ø´Ù‡Ø±ÙŠ</option>
</select>
<button onclick="window.print()">ØªØµØ¯ÙŠØ± PDF</button>
<table>
<tr><th>ØªØ§Ø±ÙŠØ®</th><th>Ù†ÙˆØ¹</th><th>Ù…Ø¨Ù„Øº</th><th>Ø¯ÙØ¹</th></tr>
<tbody id="reportTable"></tbody>
</table>
</div>
</section>

<!-- Ø§Ù„Ù†Ø³Ø®Ø© -->
<section id="backup">
<div class="card">
<button onclick="exportData()">ØªØµØ¯ÙŠØ± Ù†Ø³Ø®Ø©</button>
<input type="file" onchange="importData(event)">
</div>
</section>

<script>
let db = JSON.parse(localStorage.getItem("db")) || {
cash:0, bank:0, store:[], records:[]
};

function save(){localStorage.setItem("db",JSON.stringify(db));render();}
function show(id){
document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
event.target.classList.add("active");
}

function addItem(){
db.store.push({name:itemName.value,qty:+itemQty.value,price:+itemPrice.value});
itemName.value=itemQty.value=itemPrice.value="";
save();
}

function addSale(){
let i=saleItem.selectedIndex;
let q=+saleQty.value;
if(!db.store[i]||db.store[i].qty<q)return alert("ÙƒÙ…ÙŠØ© ØºÙŠØ± ÙƒØ§ÙÙŠØ©");
let total=db.store[i].price*q;
db.store[i].qty-=q;
db[saleType.value]+=total;
db.records.push({d:new Date(),t:"Ø¨ÙŠØ¹",a:total,w:saleType.value});
save();
}

function addExpense(){
db[expType.value]-=+expAmount.value;
db.records.push({d:new Date(),t:"Ù…ØµØ±ÙˆÙ",a:+expAmount.value,w:expType.value});
expAmount.value="";
save();
}

function render(){
cashVal.textContent=db.cash;
bankVal.textContent=db.bank;
storeTable.innerHTML="";
saleItem.innerHTML="";
db.store.forEach(i=>{
storeTable.innerHTML+=`<tr><td>${i.name}</td><td>${i.qty}</td><td>${i.price}</td></tr>`;
saleItem.innerHTML+=`<option>${i.name}</option>`;
});
renderReports();
}

function renderReports(){
reportTable.innerHTML="";
let type=reportType.value;
let now=new Date();
db.records.forEach(r=>{
let d=new Date(r.d);
if(type=="day" && d.toDateString()!=now.toDateString())return;
if(type=="month" && d.getMonth()!=now.getMonth())return;
reportTable.innerHTML+=`<tr>
<td>${d.toLocaleDateString()}</td>
<td>${r.t}</td>
<td>${r.a}</td>
<td>${r.w}</td></tr>`;
});
}

function exportData(){
let a=document.createElement("a");
a.href=URL.createObjectURL(new Blob([JSON.stringify(db)],{type:"application/json"}));
a.download="backup.json";
a.click();
}

function importData(e){
let r=new FileReader();
r.onload=()=>{db=JSON.parse(r.result);save();};
r.readAsText(e.target.files[0]);
}

render();
</script>
</body>
</html>
